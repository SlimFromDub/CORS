1. Chyb캩j칤c칤 nebo nespr치vn치 CORS konfigurace v ASP.NET

V치코 ASP.NET server mus칤 povolit CORS pro po쬬davky z konkr칠tn칤ho p콢vodu (nap콏. http://localhost). Ve va코em k칩du ji p콏id치v치te hlavi캜ky CORS, ale m치te n캩kter칠 nesrovnalosti. Zkuste aktualizovat v치코 k칩d takto:
Oprava:

protected void Page_Load(object sender, EventArgs e)
{
    HttpContext.Current.Response.AppendHeader("Access-Control-Allow-Origin", "http://localhost"); // Povolit localhost
    HttpContext.Current.Response.AppendHeader("Access-Control-Allow-Methods", "GET, POST, OPTIONS"); // Povolit HTTP metody
    HttpContext.Current.Response.AppendHeader("Access-Control-Allow-Headers", "Content-Type, Accept, Authorization"); // Povolit specifick칠 hlavi캜ky

    if (Request.HttpMethod == "OPTIONS") 
    {
        Response.StatusCode = 200; // Preflight odpov캩캞
        Response.End();
    }

    string post = new StreamReader(Request.InputStream).ReadToEnd();
    string command = ""; // Zpracujte data
    Response.Clear();
    Response.ContentType = "application/json; charset=utf-8";
    Response.Write("{\"status\":\"OK\"}"); // Dummy JSON odpov캩캞
    Response.End();
}

2. Chyb캩j칤c칤 hlavi캜ky p콏i preflight po쬬davc칤ch

Prohl칤쬰캜e prov치d캩j칤 p콏ed hlavn칤m po쬬davkem tzv. "preflight request" (metodou OPTIONS). Tyto po쬬davky mus칤 server spr치vn캩 obslou쬴t a odpov캩d캩t odpov칤daj칤c칤mi hlavi캜kami.
Co zkontrolovat:

    Ujist캩te se, 쬰 ASP.NET aplikace odpov칤d치 na po쬬davky OPTIONS spr치vn캩.

    Pokud ne, dopl켿te podporu OPTIONS metod do konfigurace webov칠ho serveru nebo handleru (viz v칳코e).

3. Nesoulad mezi hlavi캜kami v klientsk칠m po쬬davku a serverov칠 odpov캩di

Hlavi캜ka Content-Type nastaven치 v fetch mus칤 b칳t povolena na serveru. Zkuste otestovat odstran캩n칤 Content-Type z klientsk칠 str치nky, aby se minimalizovaly konflikty:
Klientsk치 oprava:

async function getInfuxData() {
    const url = 'http://localhost:64010/Default.aspx/getInfuxData';
    try {
        const response = await fetch(url, { method: 'GET' });
        const data = await response.json();
        document.getElementById('output').textContent = JSON.stringify(data, null, 2);
    } catch (error) {
        console.error('Error:', error);
        document.getElementById('output').textContent = 'Error fetching data';
    }
}

4. Chyb캩j칤c칤 nebo konfliktn칤 CORS konfigurace ve web.config

Hlavi캜ky CORS mohou b칳t tak칠 spravov치ny ve web.config. V치코 aktu치ln칤 web.config m치 nastaven칠 hlavi캜ky CORS, ale chyb칤 specifikace pro localhost.
Oprava:

Upravte sekci <customHeaders> v web.config:

<httpProtocol>
  <customHeaders>
    <add name="Access-Control-Allow-Origin" value="http://localhost" />
    <add name="Access-Control-Allow-Methods" value="GET, POST, OPTIONS" />
    <add name="Access-Control-Allow-Headers" value="Content-Type, Accept, Authorization, X-Requested-With" />
    <add name="Access-Control-Allow-Credentials" value="true" />
  </customHeaders>
</httpProtocol>

5. Testov치n칤

Po proveden칤 v칳코e uveden칳ch zm캩n:

    Zkontrolujte, 쬰 server spr치vn캩 odpov칤d치 na OPTIONS po쬬davky.

    Otestujte, zda v치코 po쬬davek GET nyn칤 funguje.

    Pou쬴jte n치stroje jako Developer Tools v prohl칤쬰캜i (Network panel) k anal칳ze odpov캩d칤.

Pokud probl칠m p콏etrv치v치, dejte v캩d캩t, a m콢쬰me ladit hloub캩ji. 游땕
